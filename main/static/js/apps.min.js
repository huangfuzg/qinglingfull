/*
Template Name: Color Admin - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.7
Version: 2.1.0
Author: Sean Ngu
Website: http://www.seantheme.com/color-admin-v2.1/frontend/e-commerce/
*/
var option = {
       mainClassName: 'pgwSlideshow',   //用你的自定义css样式来展现轮播图
        transitionEffect: 'fading',     //轮播图切换时动画效果，有两个选项sliding（滑动效果）、fading（渐隐效果）
        autoSlide: true,                //是否允许轮播图自动按照时间间隔轮播
        beforeSlide: false,              //function类型属性，在轮播图每次切换前的回调函数。如"function(id) { console.log('切换前，当前id' + id); }"
       afterSlide: false,               //function类型属性，在轮播图每次切换后的回调函数。如"function(id) { console.log('切换后，当前id' + id); }"
       displayList: true,               //是否以列表的形式显示缩略图
        displayControls: true,           //是否显示向前，向后翻页的按钮。
        touchControls: true,             //是否支持移动设备触摸翻页操作
        maxHeight: null,                 //设置轮播插件的最大高度，直接写数值即可，不需要带px单位
        transitionDuration: 500,         //图片自动轮播时，图片切换的时间，单位毫秒
        intervalDuration: 3000           //显示下一张图片之前的间隔时间单位毫秒，该参数需要autoSlide为true
    };
function getUrlParam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
            var r = window.location.search.substr(1).match(reg);  //匹配目标参数
            if (r != null) return decodeURI(r[2]); return null; //返回参数值
        }

var handleHeaderFixedTop = function() {
		0 !== $('#header[data-fixed-top="true"]').length && $(window).on("scroll", function() {
			$("body").scrollTop() >= 40 ? ($("body").css("padding-top", "76px"), $("#header").addClass("header-fixed")) : ($("#header").removeClass("header-fixed"), $("body").css("padding-top", "0"))
		})
	},
	handleProductImage = function() {
		$('[data-click="show-main-image"]').click(function(e) {
			e.preventDefault();
			var t = '[data-id="main-image"]',
				a = '<img src="' + $(this).attr("data-url") + '" />',
				i = $(this).closest("li");
			$(t).html(a), $(i).addClass("active"), $('[data-click="show-main-image"]').closest("li").not(i).removeClass("active")
		})
	},
	handleNavBar = function(){
		$('[data-toggle="tab"]').click(function(e){
			e.preventDefault();
			var a = $(this).attr("href");
			b = $('#product-tab>.active>a').attr("href");
			i = $(this).closest('li');
			if(a!=b){
				$(i).addClass("active");
				$('[data-toggle="tab"]').closest("li").not(i).removeClass("active");
				$(a).attr('class','tab-pane fade active in');
				$(b).attr('class',"tab-pane fade");
			}
		})
	}
	// 移动端增加导航栏
	pc_insertNav = function(cata){
		$.getJSON("/static/data/ac_power.json", "", function(data) {
			for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata)
				{
					var name = data[i].name;
					console.log(name);
					var a = $('.breadcrumb');
					console.log(a);
					var str = '<li>ac_power</a></li>'
					a.append(str);
					var str1 = '<li class="active">'+name+'</li>';
					a.append(str1);
				}
			}
		});
	}
	// powercord的标题
	pc_title = function(cata){
		$.getJSON("/static/data/ac_power.json", "", function(data) {
			for (var i = data.length - 1; i >= 0; i--) {
				if(data[i].id === cata)
				{
					var name = data[i].name;
					console.log(name);
					$(".page-header").text(name);
				}
			}
		});
	}
	// pc 移动端轮播图
 //   pc_mTurnImgs = function(cata) {
	// 	$.getJSON("data/data.json", "", function(data) {
 //       		console.log(data);
 //       		for (var i = data.length - 1; i >= 0; i--) {
 //       			//console.log(data[i]);
	// 			if(data[i].id === cata)
	// 			{
	// 				var imgs = [];
	// 				var name = data[i].name + "_imgs";
	// 				imgs = data[i][name];
	// 				console.log(imgs);

	// 				if(imgs.length>0){
	// 					var a = $('.breadcrumb');
	// 					var str = '<ul class="pgwSlideshow"></ul>';
	// 					a.after(str);
	// 					var b = $('.pgwSlideshow');
	// 					$.each(imgs,function(i,item){
	// 						var str = '<li><img src="data'+item+'" alt="" data-description=""></li>';
	// 						b.append(str);
	// 					})
	// 					$('.pgwSlideshow').pgwSlideshow(option);
	// 			}
	// 		}
	// 	}
	// });
	// }
	// pc 轮播图
 //   pc_TurnImgs = function(cata) {
	// 	$.getJSON("data/data.json", "", function(data) {
 //       		console.log(data);
 //       		for (var i = data.length - 1; i >= 0; i--) {
 //       			//console.log(data[i]);
	// 			if(data[i].id === cata)
	// 			{
	// 				var imgs = [];
	// 				var name = data[i].name + "_imgs";
	// 				imgs = data[i][name];
	// 				console.log(imgs);

	// 				if(imgs.length>0){
	// 					var a = $('.search-toolbar');
	// 					var str = '<ul class="pgwSlideshow"></ul>';
	// 					a.append(str);
	// 					var b = $('.pgwSlideshow');
	// 					$.each(imgs,function(i,item){
	// 						var str = '<li><img src="data'+item+'" alt="" data-description=""></li>';
	// 						b.append(str);
	// 					})
	// 					$('.pgwSlideshow').pgwSlideshow(option);
	// 				}
	// 			}
	// 		}
	// 	});
	// }
	pc_mTurnImgs = function(cata) {
		$.getJSON("/static/data/data.json", "", function(data) {
       		console.log(data);
       		for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata)
				{
					var imgs = [];
					var name = data[i].name + "_imgs";
					imgs = data[i][name];
					console.log(imgs);
					if(imgs.length>0){
						var a = $('.sw-slides');
						$.each(imgs,function(i,item){
							var str = '<li class="sw-slide"><img src="static/data'+item+'" alt="" data-description=""></li>';
							a.append(str);
						})
					}
				}

			}
			$('#full_feature').swipeslider();
		});
	}
	  pc_TurnImgs = function(cata) {
		$.getJSON("/static/data/data.json", "", function(data) {
       		console.log(data);
       		for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata)
				{
					var imgs = [];
					var name = data[i].name + "_imgs";
					imgs = data[i][name];
					console.log(imgs);
					if(imgs.length>0){
						var a = $('.sw-slides');
						$.each(imgs,function(i,item){
							var str = '<li class="sw-slide"><img src="static/data'+item+'" alt="" data-description=""></li>';
							a.append(str);
						})
					}
				}

			}
			$('#full_feature').swipeslider();
		});
	}
	// pc 增加内容表
	pc_insertTables = function(cata){	
		$.getJSON("/static/parameter/pc.json", "", function(data) {
			console.log("666666666",data);
			for (var i = data.length - 1; i >= 0; i--) {
				if(data[i].id===cata){
					var all = data[i];
				}
			}
			$.each(all.cable,function(i,item){
				//console.log(i,item);
				var name = item.name;
				var a = $('#product-desc');
				var str = '<div class="product-desc">\
                           <table class="table table-bordered '+i+'"><thead><tr><th colspan="2" style="text-align: center;">'+name+'</th></tr></thead>\
								<tbody>\
								</tbody></table>\
                           </div>';
                a.append(str);
                var b = $('.'+i);
                $.each(item,function(i,item){                 
                	if(i==="modelParams"){
                	}
                	else{
                		if(typeof(item)==="object"){
                			var len = item.length;
                			var str = '<tr><th rowspan="'+len+'">'+i+'</th><td>'+item[0]+'</td></tr>';
                			b.append(str);
                			for(var i=1;i<len;i++){
                				var str = '<tr><td>'+item[i]+'</td></tr>';
								b.append(str);
                			}               			
                		}
                		else{	                    			
							var str = '<tr><th>'+i+'</th><td>'+item+'</td></tr>';
							b.append(str);
                		}
                	}
				})
				var model = item.modelParams;
				console.log(model);	
				$.each(model,function(j,item){
					
					var smallimgs = item.img;
					console.log(smallimgs)
					var u = (i+1)*10+j;
					var uname = item.name;
					console.log(j,item);
					// var head = '<div class="linepic '+u+'_'+j+'">\
				 //          <h4 style="text-align: center">'+item.name+'</h4>\				        
				 //        </div>';
					// $.each() 循环图片
					var head = '<div class="linepic '+u+'_'+j+'" style="text-align: center";>\
					          <h4 style="text-align: center">'+uname+'</h4>\
					          \
					        </div>';
						b.after(head);
					$.each(smallimgs,function(i,item){
						
						if(smallimgs[i]!=""){
							var pic = '<img src="static/parameter/AC POWER CORD/'+item+'" alt="">';
							$('.'+u+'_'+j+' h4').after(pic);
						}
					})

					var tablehead = '<table class="table table-bordered '+u+'"><thead><tr></tr></thead>\
								<tbody>\
								</tbody></table>';
					$('.'+u+'_'+j).append(tablehead);
					$.each(item.others,function(i,item){
						//console.log(i,item);
						var tb = $('.'+u+' tbody');
						var str = '<tr class="'+u+'-'+i+'"></tr>'
						tb.append(str);
						var tables = item;
						$.each(tables,function(k,item){
							//console.log(i,u,k,item);
							if(i==0){
								var c = $('.'+u+' thead tr');
								var str = '<th>'+k+'</th>';
								c.append(str);	
							}
							else{
								var c = $('.'+u+'-'+i);
								//console.log(c);
								var str = '<td>'+item+'</td>';
								c.append(str);	
							}
						})
					})
				})	
			})
			
		})
	}
	// pc 增加表对应的线的图片
	pc_insertLineImgs = function(cata){
		$.getJSON("/static/data/ac_power.json", "", function(data) {
			for (var i = data.length - 1; i >= 0; i--) {
				if(data[i].id === cata)
				{
					var lines = [];
					lines = data[i].line;
					console.log(lines);
					$.each(lines,function(i,item){
						var a = $('#product-desc');
						var str = '<div class="product-desc">\
                          <div class="image1">\
                              <img src="data/'+item+'" alt="" style="width: 100%" />\
                          </div></div>';
                        a.append(str);
					})
				}
			}
		});
	}
	// pc 增加主要介绍
		pc_insertContent = function(cata){
		$.getJSON("/static/parameter/pc.json", "", function(data) {
			console.log(data);
			for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata){
					var detail = data[i].plugs;
					console.log(detail)
					
					$.each(detail,function(i,item){
						var a = $('#product-desc');
						console.log(i,item);
						if(i%2===0){
							var str = '<div class="product-desc" id="all_'+i+'">\
							<div class="image"><img src="static/parameter/AC POWER CORD/'+item.drawing+'" alt="" />\
                          </div><div class="desc"><h3>Corresponding line specifications</h3><ul class="product-info-list1" id="'+i+'">\
							</ul></div></div>'
							a.append(str);
							var id = "#" + i;
							console.log(id)
							var b = $(id);
							$.each(item.cabels,function(i,item){
								//console.log(item)
								var str2 = '<li><i class="fa fa-circle">'+' '+item+'</i></li>';
								b.append(str2)
							})
							if(item.picture!=""){
								var a = $('#all_'+i);
								var str = '<div class="corr">\
		                          <div class="image1">\
		                              <img src="static/parameter/AC POWER CORD/'+item.picture+'" alt=""  />\
		                          </div></div>';
		                        a.append(str);                    	
							}
						}
						if(i%2===1){
							var str = '<div class="product-desc right"  id="all_'+i+'">\
							<div class="image"><img src="static/parameter/AC POWER CORD/'+item.drawing+'" alt="" />\
                          </div><div class="desc"><h3>Corresponding line specifications</h3><ul class="product-info-list2" id="'+i+'">\
							</ul></div></div>'
							a.append(str);
							var id = "#" + i;
							//console.log(id);
							var b = $(id);
							$.each(item.cabels,function(i,item){
								console.log(item)
								var str2 = '<li><i class="fa fa-circle">'+' '+item+'</i></li>';
								b.append(str2)
							})
							if(item.picture!=""){
								var a = $('#all_'+i);
								var str = '<div class="corr">\
		                          <div class="image1">\
		                              <img src="static/parameter/AC POWER CORD/'+item.picture+'" alt=""  />\
		                          </div></div>';
		                        a.append(str);                    	
							}
						}
					})
				}
			}
		});
	}
	// pc_insertContent = function(cata){
	// 	$.getJSON("data/ac_power.json", "", function(data) {
	// 		for (var i = data.length - 1; i >= 0; i--) {
 //       			//console.log(data[i]);
	// 			if(data[i].id === cata)
	// 			{
	// 				var content = [];
	// 				content = data[i].products;
	// 				console.log(content[0]);
	// 				if(content[0].imgurl!=""){
	// 				$.each(content,function(i,item){
	// 					var imgurl = "data/" + item.imgurl;
	// 					var a = $('#product-desc');
	// 					var details = item.description;
	// 					if(i%2===0){
	// 						//console.log(details);
	// 						var str = '<div class="product-desc">\
	// 						<div class="image"><img src="'+imgurl+'" alt="" />\
 //                          </div><div class="desc"><h3>Corresponding line specifications</h3><ul class="product-info-list1" id="'+i+'">\
	// 						</ul></div></div>'
	// 						a.append(str);
	// 						var id = "#" + i;
	// 						console.log(id)
	// 						var b = $(id);
	// 						$.each(details,function(i,item){
	// 							var str2 = '<li><i class="fa fa-circle">'+' '+item+'</i></li>';
	// 							b.append(str2)
	// 						})
	// 					}
	// 					if(i%2===1){
	// 						//console.log(details);
	// 						var str = '<div class="product-desc right">\
	// 						<div class="image"><img src="'+imgurl+'" alt="" />\
 //                          </div><div class="desc"><h3>Corresponding line specifications</h3><ul class="product-info-list2" id="'+i+'">\
	// 						</ul></div></div>'
	// 						a.append(str);
	// 						var id = "#" + i;
	// 						//console.log(id);
	// 						var b = $(id);
	// 						$.each(details,function(i,item){
	// 							var str2 = '<li><i class="fa fa-circle">'+' '+item+'</i></li>';
	// 							b.append(str2)
	// 						})
	// 					}
	// 				})
	// 			}
	// 			}
	// 	}
	// });
	// }
	product_TurnImgs = function(cata,pname) {
		$.getJSON("/static/data/"+pname+".json", "", function(data) {
       		console.log(data);
       		for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata)
				{
					var imgs = data[i].imgurl;

					console.log(imgs);

					if(imgs.length>0){
						var a = $('.sw-slides');
						$.each(imgs,function(i,item){
							var str = '<li class="sw-slide"><img src="static/data'+item+'" alt="" data-description=""></li>';
							a.append(str);
						})
					}
				}
			}
			$('#full_feature').swipeslider();
		});
	}
	product_mTurnImgs = function(cata,pname) {
		$.getJSON("/static/data/"+pname+".json", "", function(data) {
       		console.log(data);
       		for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata)
				{
					var imgs = data[i].imgurl;

					console.log(imgs);

					if(imgs.length>0){
						var a = $('.sw-slides');
						$.each(imgs,function(i,item){
							var str = '<li class="sw-slide"><img src="static/data'+item+'" alt="" data-description=""></li>';
							a.append(str);
						})
					}
				}
			}
			$('#full_feature').swipeslider();
		});
	}
	product_title = function(cata,pname){
		$.getJSON("/static/data/"+pname+".json", "", function(data) {
       		console.log(data);
       		for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata)
				{
					var name = data[i].name;
					$(".page-header").text(name);
				}
			}
		});
	}
	product_Content = function(cata,pname){
		$.getJSON("/static/parameter/"+pname+".json", "", function(data) {
       		console.log(data);
       		for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata)
				{
					var name = data[i].name;
					var para =[];
					para = data[i].parameter;
					console.log(para);
					var tablehead = '<table class="table table-bordered"><thead><tr><th colspan="2" style="text-align: center;">'+name+'</th></tr></thead>\
								<tbody>\
								</tbody></table>';
					var a = $('#product-desc');
                    a.append(tablehead);
                    var b = $('tbody');
                    $.each(para,function(i,item){
	                    	console.log(item);
	                    	for(var a in item){
								console.log(item[a],a);
							}
							var str = '<tr><th>'+a+'</th><td>'+item[a]+'</td></tr>';
							b.append(str);
						})
				}
			}
		});
	}
	product_insertNav = function(cata,pname){
		$.getJSON("/static/data/"+pname+".json", "", function(data) {
			for (var i = data.length - 1; i >= 0; i--) {
       			//console.log(data[i]);
				if(data[i].id === cata)
				{
					var name = data[i].name;
					console.log(name);
					var a = $('.breadcrumb');
					console.log(a);
					var str = '<li>'+pname+'</li>'
					a.append(str);
					var str1 = '<li class="active">'+name+'</li>';
					a.append(str1);
				}
			}
		});
	}
	show_sidebar = function(type,pname,cata){
		var a = $('.shown [href="javascript:void(0);"]');
		$.each(a,function(i,item){
			if(item.text==cata){
				$obj = $(item);
				$obj.closest('li').addClass("active");
			}
		})
		if(pname!=null){
			$.getJSON("/static/data/"+pname+".json", "", function(data) {
				if (pname=="USB cable") {
					$('.sub-menu1').addClass("active");
					$('.usb').css({
						display: 'block'
					});
				}
	       		for (var i = data.length - 1; i >= 0; i--) {
	       			//console.log(data[i]);
					if(data[i].id === type)
					{
						var name = data[i].name;
						console.log(name);
						var b = $('.detail');
						//console.log(b);
						$.each(b,function(i,item){
							if(item.innerText.trim()===name){
								$o = $(item);
								//console.log($o);
								$o.closest('li').addClass("active");
							}
						})
					}
				}
			});
		}
		else{
			$.getJSON("/static/data/ac_power.json", "", function(data) {
	       		for (var i = data.length - 1; i >= 0; i--) {
	       			//console.log(data[i]);
					if(data[i].id === type)
					{
						var name = data[i].name;
						console.log(name);
						var b = $('.detail');
						console.log(b);
						$.each(b,function(i,item){
							if(item.innerText.trim()===name){
								$o = $(item);
								console.log($o);
								$o.closest('li').addClass("active");
							}
						})
					}
				}
			});
		}
		
	}
	mobileNav = function(){
		// Mobile Navigation
		  if ($('#nav-menu-container').length) {
		    var $mobile_nav = $('#nav-menu-container').clone().prop({
		      id: 'mobile-nav'
		    });
		    $mobile_nav.find('> ul').attr({
		      'class': '',
		      'id': ''
		    });
		    $('body').append($mobile_nav);
		    $('body').prepend('<button type="button" id="mobile-nav-toggle"><i class="fa fa-bars"></i></button>');
		    $('body').append('<div id="mobile-body-overly"></div>');
		    $('#mobile-nav').find('.menu-has-children').prepend('<i class="fa fa-chevron-down"></i>');

		    $(document).on('click', '.menu-has-children i', function(e) {
		      $(this).next().toggleClass('menu-item-active');
		      $(this).nextAll('ul').eq(0).slideToggle();
		      $(this).toggleClass("fa-chevron-up fa-chevron-down");
		    });

		    $(document).on('click', '#mobile-nav-toggle', function(e) {
		      $('body').toggleClass('mobile-nav-active');
		      $('#mobile-nav-toggle i').toggleClass('fa-times fa-bars');
		      $('#mobile-body-overly').toggle();
		    });

		    $(document).click(function(e) {
		      var container = $("#mobile-nav, #mobile-nav-toggle");
		      if (!container.is(e.target) && container.has(e.target).length === 0) {
		        if ($('body').hasClass('mobile-nav-active')) {
		          $('body').removeClass('mobile-nav-active');
		          $('#mobile-nav-toggle i').toggleClass('fa-times fa-bars');
		          $('#mobile-body-overly').fadeOut();
		        }
		      }
		    });
		  } else if ($("#mobile-nav, #mobile-nav-toggle").length) {
		    $("#mobile-nav, #mobile-nav-toggle").hide();
		  }
	}
	App = function() {
	
		"use strict";
		return {
			init_mpowercord:function() {
				var type = getUrlParam("type");
				mobileNav(),pc_title(type),pc_insertNav(type),pc_mTurnImgs(type),pc_insertContent(type),pc_insertTables(type)
				//pc_insertLineImgs(type);
			},
			init_mother: function(){
				// var type = "02", pname = "network_cable";
		        var type = getUrlParam("type");
		        var pname = getUrlParam("pname");
		        console.log(type,pname);
				mobileNav(),product_mTurnImgs(type,pname),product_Content(type,pname),product_title(type,pname),product_insertNav(type,pname);
			},
			init_pc: function(){
				var type = getUrlParam("type");
				var pname = getUrlParam("pname");
				var cata = getUrlParam("cata");
				console.log(type,pname,cata);
				mobileNav(),pc_title(type),pc_insertContent(type),show_sidebar(type,pname,cata),pc_insertTables(type),pc_TurnImgs(type)
				//pc_insertLineImgs(type)
				//$('.pgwSlideshow').pgwSlideshow(option);
			},
			init_other: function(){
				var type = getUrlParam("type");
		        var pname = getUrlParam("pname");
		        var cata = getUrlParam("cata");
		        console.log(type,pname,cata);
				mobileNav(),product_TurnImgs(type,pname),product_Content(type,pname),product_title(type,pname),show_sidebar(type,pname,cata);
			}
		}
	}();
